# Как работает HTTP сервер для загрузки файлов

## Что делает сервис?

Это HTTP сервер, который:
1. **Принимает файлы** через веб-браузер
2. **Сохраняет их** на сервере в указанную директорию
3. **Требует авторизацию** для загрузки файлов (защита от несанкционированного доступа)

## Как это работает?

### 1. Запуск сервера
```bash
./simple_http server.conf
```

Сервер запускается и слушает порт 8080 (или другой, указанный в конфиге).

### 2. Открытие в браузере
Откройте `http://localhost:8080` в браузере.

Вы увидите форму с кнопкой "Выбрать файл".

### 3. Загрузка файла

**Шаг 1:** Нажмите "Выбрать файл" и выберите файл на вашем компьютере

**Шаг 2:** Нажмите кнопку "Upload"

**Шаг 3:** Появится диалог с запросом Username - введите `admin` (или значение из server.conf)

**Шаг 4:** Появится диалог с запросом Password - введите `admin` (или значение из server.conf)

**Шаг 5:** Файл будет загружен на сервер

### 4. Где сохраняется файл?

Файл сохраняется в директорию, указанную в `server.conf`:
- По умолчанию: `/tmp/`
- Имя файла берется из оригинального имени файла

Проверить можно так:
```bash
ls -la /tmp/
```

## Почему была ошибка 401?

Ошибка 401 (Unauthorized) возникала потому, что:
- Сервер требует авторизацию для загрузки файлов
- Браузер не отправлял заголовок Authorization автоматически при отправке формы

**Решение:** Теперь форма использует JavaScript, который:
1. Запрашивает логин и пароль у пользователя
2. Кодирует их в base64
3. Отправляет заголовок Authorization вместе с файлом

## Тестирование через curl

Если хотите протестировать без браузера:

```bash
# Загрузить файл с авторизацией
curl -u admin:admin -F "file=@путь/к/файлу.txt" http://localhost:8080/upload
```

## Отключение авторизации

Если хотите отключить авторизацию (не рекомендуется для продакшена):

Отредактируйте `server.conf`:
```
auth_enabled=false
```

Тогда файлы можно будет загружать без логина и пароля.

## Что происходит технически?

1. **GET /** - браузер запрашивает главную страницу, сервер отправляет HTML форму
2. **POST /upload** - браузер отправляет файл через multipart/form-data
3. Сервер проверяет авторизацию (заголовок Authorization)
4. Сервер парсит multipart данные, извлекает файл
5. Сервер сохраняет файл в указанную директорию
6. Сервер отправляет ответ об успешной загрузке
